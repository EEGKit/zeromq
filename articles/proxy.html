<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Proxy </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Proxy ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="proxy">
<h1 id="proxy-intermediation">Proxy (Intermediation)</h1>

<p>The basic messaging patterns in ZeroMQ use direct connections between socket endpoints. The role of proxies, or <em>intermediaries</em>, is to abstract away direct references between endpoints, replacing them by references to the proxy.</p>
<p>The proxy itself is specified by exposing a <a class="xref" href="../api/Bonsai.ZeroMQ.ProxyFrontend.html">ProxyFrontend</a> socket and a <a class="xref" href="../api/Bonsai.ZeroMQ.ProxyBackend.html">ProxyBackend</a> socket. All primary messages are routed from front-end to back-end, but secondary responses or subscription messages can also flow from back-end to front-end as required by the specified socket types.</p>
<p>This enables easily building variants of the basic patterns where peers are discovered dynamically or pools of clients and services can join and leave at any time, with the only constraint that all message passing is stateless. The examples below illustrate some of the most common proxy patterns.</p>
<h3 id="example-extended-publish-subscribe"><strong>Example:</strong> Extended Publish-Subscribe</h3>
<p>In the basic <a class="xref" href="pub-sub.html">Publish-Subscribe</a> pattern, a set of subscribers connect to a single publisher. Typically the publisher binds to its endpoint and does not know the identity of the subscribers. However, all subscribers have to know the identity of the publisher endpoint. This makes it hard to replace the publisher, or to allow for multiple publishers to push data to subscribers.</p>
<p>The extended publish-subscribe pattern allows for dynamic discovery of both publishers and subscribers by introducing a proxy. This way, publishers do not need to know the identity of subscribers, and subscribers do not need to know the identity of publishers. Only the identity of the proxy endpoints is required.</p>
<pre><code class="lang-mermaid">graph LR
    A(Publisher) ---|PUB| D(&lt;p&gt;&lt;/p&gt;)
    B(Publisher) ---|PUB| D(&lt;p&gt;&lt;/p&gt;)
    C(Publisher) ---|PUB| D(&lt;p&gt;&lt;/p&gt;)
    D ---|XSUB| E(Proxy)
    E ---|XPUB| F(&lt;p&gt;&lt;/p&gt;)
    F --&gt;|SUB| G(Subscriber)
    F --&gt;|SUB| H(Subscriber)
    F --&gt;|SUB| I(Subscriber)
</code></pre>
<p>The proxy needs to be configured with a <a class="xref" href="../api/Bonsai.ZeroMQ.SocketType.html#Bonsai_ZeroMQ_SocketType_XSubscriber">XSubscriber</a> as the front-end socket, and a <a class="xref" href="../api/Bonsai.ZeroMQ.SocketType.html#Bonsai_ZeroMQ_SocketType_XPublisher">XPublisher</a> as the back-end socket. In the example below, two timers publish periodic updates to an unknown set of subscribers using this proxy pattern.</p>
<div class="workflow"><p><img src="../workflows/xpub-xsub.bonsai" alt="XPub-XSub workflow"></p>
</div>
<h3 id="example-extended-request-response"><strong>Example:</strong> Extended Request-Response</h3>
<p>In the basic <a class="xref" href="req-rep.html">Request-Response</a> pattern, one client connects to a single server. We can also use <a class="xref" href="router-dealer.html">Router-Dealer</a> patterns so that multiple asynchronous requests can be handled in parallel by the server. However, in both cases we assume there is a single endpoint for handling service requests which is known by all clients.</p>
<p>The extended request-response pattern allows for clusters of workers to dynamically join or leave a shared message queue, and handle requests from existing clients as they arrive. The client connects to the proxy front-end, and workers to the proxy back-end. This way we can scale up the number of workers without having to change anything about the clients.</p>
<pre><code class="lang-mermaid">graph LR
    A(Client) ---|REQ| D(&lt;p&gt;&lt;/p&gt;)
    B(Client) ---|REQ| D(&lt;p&gt;&lt;/p&gt;)
    C(Client) ---|REQ| D(&lt;p&gt;&lt;/p&gt;)
    D ---|Router| E(Proxy)
    E ---|Dealer| F(&lt;p&gt;&lt;/p&gt;)
    F --&gt;|REP| G(Worker)
    F --&gt;|REP| H(Worker)
    F --&gt;|REP| I(Worker)
</code></pre>
<p>The shared queue is simply a proxy configured with a <a class="xref" href="../api/Bonsai.ZeroMQ.SocketType.html#Bonsai_ZeroMQ_SocketType_Router">Router</a> as the front-end socket, and a <a class="xref" href="../api/Bonsai.ZeroMQ.SocketType.html#Bonsai_ZeroMQ_SocketType_Dealer">Dealer</a> as the back-end socket. In the example below, a timer sends periodic requests to the shared queue, and workers alternate servicing the requests.</p>
<p>Each reply is tagged with the identity of the worker who handled the request for easy visualization.</p>
<div class="workflow"><p><img src="../workflows/router-dealer-proxy.bonsai" alt="Router-Dealer proxy"></p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/bonsai-rx/zeromq/blob/main/docs/articles/proxy.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    <!-- Mermaid -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript" src="https://unpkg.com/mermaid@9.1.3/dist/mermaid.min.js" integrity="sha384-LnGjpNDrP4cp7MIk4CpRa/lPNclrf839ryYVFx1T1mPSV3RGAZ7nlBa7pqcyGY/K" crossorigin="anonymous"></script>
    <!-- Initialize Mermaid -->
    <script>
        mermaid.initialize({
            startOnLoad: false
        });
        mermaid.init(undefined, ".lang-mermaid");
    </script>  </body>
</html>
